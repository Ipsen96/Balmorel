$ifi not %SMART%==yes $goto SMART_END
*+ SUM((S),
       +VEV_VNETCHARGE_BEV(IY411,IR,IS3,T)
       +VEV_VNETCHARGE_PHEV(IY411,IR,IS3,T)
       -VEV_VNETDISCHARGE_BEV(IY411,IR,IS3,T)
       -VEV_VNETDISCHARGE_PHEV(IY411,IR,IS3,T)

*         )

$label  SMART_END

$ifi not %V2G%==yes $goto V2G_END
*+ SUM((S),
       +VEV_VNETCHARGE_BEV(IY411,IR,IS3,T)
       +VEV_VNETCHARGE_PHEV(IY411,IR,IS3,T)
       -VEV_VNETDISCHARGE_BEV(IY411,IR,IS3,T)
       -VEV_VNETDISCHARGE_PHEV(IY411,IR,IS3,T)
*         )

$label  V2G_END






$ifi not %DUMB%==yes $goto DUMB_END


       +VEV_VNETCHARGE_BEV(IY411,IR,IS3,T)
       +VEV_VNETCHARGE_PHEV(IY411,IR,IS3,T)
       -VEV_VNETDISCHARGE_BEV(IY411,IR,IS3,T)
       -VEV_VNETDISCHARGE_PHEV(IY411,IR,IS3,T)
$label  DUMB_END







$ifi not %STEPCHARGSCHEME%==yes $goto STEPCHARGSCHEME_END



       +(EV_BEV_Dumb(IY411,IS3,T,IR)*(1/EV_PEFF(IY411)) + EV_PHEV_Dumb(IY411,IS3,T,IR)*(1/EV_PEFF(IY411)))$(IY411.val = 2030)

       +(VEV_VG2V_BEV(IY411,IR,IS3,T)
       + EV_BEV_Inflex(IY411,IS3,T,IR) * (1/EV_PEFF(IY411))
       + VEV_VG2V_PHEV(IY411,IR,IS3,T)
       + EV_PHEV_Inflex(IY411,IS3,T,IR) * (1/EV_PEFF(IY411)))$(IY411.val = 2040)

       +(VEV_VG2V_BEV(IY411,IR,IS3,T)
       + EV_BEV_Inflex(IY411,IS3,T,IR) * (1/EV_PEFF(IY411))
       -VEV_VV2G_BEV(IY411,IR,IS3,T)
       + VEV_VG2V_PHEV(IY411,IR,IS3,T)
       + EV_PHEV_Inflex(IY411,IS3,T,IR) * (1/EV_PEFF(IY411))
       -VEV_VV2G_PHEV(IY411,IR,IS3,T))$(IY411.val = 2050)

$label  STEPCHARGSCHEME_END
