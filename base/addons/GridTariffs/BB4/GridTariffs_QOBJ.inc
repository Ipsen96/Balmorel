* Additions to the objective function:


*** TAXES ON DISTRICT HEATING. Include electrolysers here?
* Fixed component and subscribed power (per MW installed)
                 + IOF1000 * SUM(IR, SUM(IAGK_HASORPOT(Y,IA,IGETOH)$RRRAAA(IR,IA),
                         IGR_PRICE_TECH(Y,IR,'GRDSUBS')  * (VGKNACCUMNET(Y,IA,IGETOH) + GKFX(Y,IA,IGETOH)) /(GDATA(IGETOH,'GDFE') *(1$(NOT GEFFRATE(IA,IGETOH))+GEFFRATE(IA,IGETOH)))     ))
* Energy charge winter
                 + SUM(IGR_TIME('GRDECW',IR,IS3,T), SUM(IAGK_HASORPOT(Y,IA,IGETOH)$RRRAAA(IR,IA),IHOURSINST(IS3,T) * IGR_PRICE_TECH(Y,IR,'GRDECW')  * VGE_T(Y,IA,IGETOH,IS3,T)))
* Energy charge summer
                 + SUM(IGR_TIME('GRDECS',IR,IS3,T), SUM(IAGK_HASORPOT(Y,IA,IGETOH)$RRRAAA(IR,IA),IHOURSINST(IS3,T) * IGR_PRICE_TECH(Y,IR,'GRDECS')  * VGE_T(Y,IA,IGETOH,IS3,T)))
* Energy charge TOU step 1
                 + SUM(IGR_TIME('GRDTOU1',IR,IS3,T),  SUM(IAGK_HASORPOT(Y,IA,IGETOH)$RRRAAA(IR,IA),IHOURSINST(IS3,T) * IGR_PRICE_TECH(Y,IR,'GRDTOU1')  * VGE_T(Y,IA,IGETOH,IS3,T)))
* Energy charge TOU step 2
                 + SUM(IGR_TIME('GRDTOU2',IR,IS3,T),  SUM(IAGK_HASORPOT(Y,IA,IGETOH)$RRRAAA(IR,IA),IHOURSINST(IS3,T) * IGR_PRICE_TECH(Y,IR,'GRDTOU2')  * VGE_T(Y,IA,IGETOH,IS3,T)))
* Energy charge TOU step 3
                 + SUM(IGR_TIME('GRDTOU3',IR,IS3,T),  SUM(IAGK_HASORPOT(Y,IA,IGETOH)$RRRAAA(IR,IA),IHOURSINST(IS3,T) * IGR_PRICE_TECH(Y,IR,'GRDTOU3')  * VGE_T(Y,IA,IGETOH,IS3,T)))
* Energy charge TOU step 4
                 + SUM(IGR_TIME('GRDTOU4',IR,IS3,T),  SUM(IAGK_HASORPOT(Y,IA,IGETOH)$RRRAAA(IR,IA),IHOURSINST(IS3,T) * IGR_PRICE_TECH(Y,IR,'GRDTOU4')  * VGE_T(Y,IA,IGETOH,IS3,T)))
* Demand charge winter
                 + IOF1000 * SUM((IR,MMM)$(SUM((IS3,T)$IGR_TIME('GRDDCW',IR,IS3,T), ISSSTTTMMM(IS3,T,MMM))), SUM(IA$(SUM(IGETOH,IAGK_HASORPOT(Y,IA,IGETOH)) AND RRRAAA(IR,IA)), VGETOH_CAP1(Y,IA,MMM)) *  IGR_PRICE_TECH(Y,IR,'GRDDCW'))/(IGR_MONTHSINSIM/card(MMM))    !! Demand charge winter
* Demand charge summer
                 + IOF1000 * SUM((IR,MMM)$(SUM((IS3,T)$IGR_TIME('GRDDCS',IR,IS3,T), ISSSTTTMMM(IS3,T,MMM))), SUM(IA$(SUM(IGETOH,IAGK_HASORPOT(Y,IA,IGETOH)) AND RRRAAA(IR,IA)), VGETOH_CAP1(Y,IA,MMM)) *  IGR_PRICE_TECH(Y,IR,'GRDDCS'))/(IGR_MONTHSINSIM/card(MMM))    !! Demand charge summer
* Demand charge 2 (e.g for spring and fall months)
                 + IOF1000 * SUM((IR,MMM)$(SUM((IS3,T)$IGR_TIME('GRDDC2',IR,IS3,T), ISSSTTTMMM(IS3,T,MMM))), SUM(IA$(SUM(IGETOH,IAGK_HASORPOT(Y,IA,IGETOH)) AND RRRAAA(IR,IA)), VGETOH_CAP1(Y,IA,MMM)) *  IGR_PRICE_TECH(Y,IR,'GRDDC2'))/(IGR_MONTHSINSIM/card(MMM))    !! Demand charge 2
* Demand charge TOU
                 + IOF1000 * SUM((IR,MMM),   SUM(IA$(SUM(IGETOH,IAGK_HASORPOT(Y,IA,IGETOH)) AND RRRAAA(IR,IA)), VGETOH_CAP2(Y,IA,MMM)) *  IGR_PRICE_TECH(Y,IR,'GRDDCTOU'))/(IGR_MONTHSINSIM/card(MMM))
* Demand charge yearly
                 + IOF1000 * SUM(IR,   SUM(IA$(SUM(IGETOH,IAGK_HASORPOT(Y,IA,IGETOH)) AND RRRAAA(IR,IA)), VGETOH_CAPY(Y,IA)) *  IGR_PRICE_TECH(Y,IR,'GRDDCY'))



* Tariffs on user groups
                 + SUM((IGR_TIME('GRDECW',IR,IS3,T),DEUSER),   IHOURSINST(IS3,T) * IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDECW')  * VDENET_T(Y,IR,DEUSER,IS3,T)$(IDE_SUMST(IR,DEUSER) GT 0) )
                 + SUM((IGR_TIME('GRDECS',IR,IS3,T),DEUSER),   IHOURSINST(IS3,T) * IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDECS')  * VDENET_T(Y,IR,DEUSER,IS3,T)$(IDE_SUMST(IR,DEUSER) GT 0) )
                 + SUM((IGR_TIME('GRDTOU1',IR,IS3,T),DEUSER),  IHOURSINST(IS3,T) * IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDTOU1') * VDENET_T(Y,IR,DEUSER,IS3,T)$(IDE_SUMST(IR,DEUSER) GT 0) )
                 + SUM((IGR_TIME('GRDTOU2',IR,IS3,T),DEUSER),  IHOURSINST(IS3,T) * IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDTOU2') * VDENET_T(Y,IR,DEUSER,IS3,T)$(IDE_SUMST(IR,DEUSER) GT 0) )
                 + SUM((IGR_TIME('GRDTOU3',IR,IS3,T),DEUSER),  IHOURSINST(IS3,T) * IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDTOU3') * VDENET_T(Y,IR,DEUSER,IS3,T)$(IDE_SUMST(IR,DEUSER) GT 0) )
                 + SUM((IGR_TIME('GRDTOU4',IR,IS3,T),DEUSER),  IHOURSINST(IS3,T) * IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDTOU4') * VDENET_T(Y,IR,DEUSER,IS3,T)$(IDE_SUMST(IR,DEUSER) GT 0) )

                 + IOF1000 * SUM((IR,DEUSER,MMM)$(SUM((IS3,T)$IGR_TIME('GRDDCW',IR,IS3,T), ISSSTTTMMM(IS3,T,MMM))), VDEUSER_CAP1(Y,IR,DEUSER,MMM) *  IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDDCW'))/(IGR_MONTHSINSIM/CARD(MMM))    !! Demand charge winter
                 + IOF1000 * SUM((IR,DEUSER,MMM)$(SUM((IS3,T)$IGR_TIME('GRDDCS',IR,IS3,T), ISSSTTTMMM(IS3,T,MMM))), VDEUSER_CAP1(Y,IR,DEUSER,MMM) *  IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDDCS'))/(IGR_MONTHSINSIM/CARD(MMM))    !! Demand charge summer
                 + IOF1000 * SUM((IR,DEUSER,MMM)$(SUM((IS3,T)$IGR_TIME('GRDDC2',IR,IS3,T), ISSSTTTMMM(IS3,T,MMM))), VDEUSER_CAP1(Y,IR,DEUSER,MMM) *  IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDDC2'))/(IGR_MONTHSINSIM/CARD(MMM))    !! Demand charge 2
                 + IOF1000 * SUM((IR,DEUSER,MMM),   VDEUSER_CAP2(Y,IR,DEUSER,MMM) *  IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDDCTOU'))/(IGR_MONTHSINSIM/card(MMM))
                 + IOF1000 * SUM((IR,DEUSER),  VDEUSER_CAPY(Y,IR,DEUSER) *  IGR_PRICE_DEUSER(Y,IR,DEUSER,'GRDDCY'))




* Gridtariff on natgas and biong consumption for heat production
    + SUM((C,IS3,T), SUM(IAGK_HASORPOT(Y,IA,G)$(GDATA(G,'GDFUEL') EQ FDATA('NATGAS','FDACRONYM')),
         IHOURSINST(IS3,T) * 4.95 * GDATA(G,'GDCV') * VGH_T(Y,IA,G,IS3,T)/ (GDATA(G,'GDFE') * (1$(NOT GEFFRATE(IA,G))+GEFFRATE(IA,G)))))

    + SUM((C,IS3,T), SUM(IAGK_HASORPOT(Y,IA,G)$(GDATA(G,'GDFUEL') EQ FDATA('BIONG','FDACRONYM')),
         IHOURSINST(IS3,T) * 4.95 * GDATA(G,'GDCV') * VGH_T(Y,IA,G,IS3,T)/ (GDATA(G,'GDFE') * (1$(NOT GEFFRATE(IA,G))+GEFFRATE(IA,G)))))



$ifi not %indheAT%==yes  $goto label_GridTariffs_qobj_indheAT_END
* Gas grid tariff
   + SUM(C, 11.52*
         SUM(

                 (INDHEAT_IA,INDHEAT_G,INDHEAT_GROUP,FFF)$(ICA(C,INDHEAT_IA) AND INDHEAT_GDATA(INDHEAT_G,'GDFUEL') EQ FDATA('BIONG','FDACRONYM') AND ( INDHEAT_GINGROUP(INDHEAT_G,INDHEAT_GROUP))
                 ),

                 SUM((IS3,T),
                         IHOURSINST(IS3,T)  * INDHEAT_VGF_T(Y,INDHEAT_IA,INDHEAT_G,INDHEAT_GROUP,IS3,T))
             )
         )

   + SUM(C, 11.52*
         SUM(

                 (INDHEAT_IA,INDHEAT_G,INDHEAT_GROUP,FFF)$(ICA(C,INDHEAT_IA) AND INDHEAT_GDATA(INDHEAT_G,'GDFUEL') EQ FDATA('NATGAS','FDACRONYM') AND ( INDHEAT_GINGROUP(INDHEAT_G,INDHEAT_GROUP))
                 ),

                 SUM((IS3,T),
                         IHOURSINST(IS3,T)  * INDHEAT_VGF_T(Y,INDHEAT_IA,INDHEAT_G,INDHEAT_GROUP,IS3,T))
             )
         )

* http://www.nordicenergyregulators.org/wp-content/uploads/2015/03/Tariffs-in-Nordic-countries-survey-of-load-tariffs-in-DSO-grids.pdf
* https://backend.orbit.dtu.dk/ws/portalfiles/portal/121099206/The_residential_electricity_sector_in_Denmark.pdf
* Only transmission system cost... no distribution grid tariff which is  42.35

   + SUM(C,
         11.5
$ifi not %P2HGTREDU%==yes  $goto label_P2HGTREDU_END
         /2
$LABEL label_P2HGTREDU_END
         *SUM(

                 (INDHEAT_IA,INDHEAT_G,INDHEAT_GROUP,FFF)$(ICA(C,INDHEAT_IA) AND INDHEAT_GDATA(INDHEAT_G,'GDFUEL') EQ FDATA('ELECTRIC','FDACRONYM') AND ( INDHEAT_GINGROUP(INDHEAT_G,INDHEAT_GROUP))
                 ),

                 SUM((IS3,T),
                         IHOURSINST(IS3,T)  * INDHEAT_VGF_T(Y,INDHEAT_IA,INDHEAT_G,INDHEAT_GROUP,IS3,T))
             )
         )



$LABEL label_GridTariffs_qobj_indheAT_END



